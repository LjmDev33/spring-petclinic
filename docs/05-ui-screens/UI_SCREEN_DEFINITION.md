# 📱 UI 화면 정의서 (UI Screen Specification)

**프로젝트**: Spring PetClinic  
**버전**: 3.5.3  
**최종 수정일**: 2025-11-06  
**작성자**: Jeongmin Lee

---

## 📑 목차

1. [개요](#1-개요)
2. [공통 컴포넌트](#2-공통-컴포넌트)
3. [사용자 인증 화면](#3-사용자-인증-화면)
4. [온라인상담 화면](#4-온라인상담-화면)
5. [커뮤니티 화면](#5-커뮤니티-화면)
6. [관리자 화면](#6-관리자-화면)
7. [변경 이력](#7-변경-이력)

---

## 1. 개요

### 1.1 문서 목적
- UI 화면 구조 및 레이아웃 정의
- 화면별 기능 및 동작 명세
- 화면 간 전환 플로우 정의
- 화면 변경 이력 관리

### 1.2 기술 스택
- **Frontend**: HTML5, Thymeleaf, Bootstrap 5.3.6
- **CSS Framework**: Bootstrap 5 + Custom CSS
- **JavaScript**: Vanilla JS (jQuery 미사용)
- **Layout**: Thymeleaf Layout Dialect (fragments/layout.html)

### 1.3 화면 해상도 지원
- Desktop: 1280px ~ 1920px (권장: 1920x1080)
- Tablet: 768px ~ 1024px
- Mobile: 320px ~ 767px (반응형 지원)

---

## 2. 공통 컴포넌트

### 2.1 레이아웃 구조 (fragments/layout.html)

#### 파일 경로
`src/main/resources/templates/fragments/layout.html`

#### 구조
```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <!-- Meta Tags -->
  <!-- CSS -->
  <!-- Font Awesome -->
</head>
<body>
  <!-- Header -->
  <div id="header">
    <!-- 로그인 상태 표시 -->
    <!-- 로그인/로그아웃 링크 -->
  </div>
  
  <!-- Navigation Bar -->
  <nav class="navbar">
    <!-- 메인 메뉴 -->
  </nav>
  
  <!-- Main Content -->
  <main>
    <div th:replace="${template}"></div>
  </main>
  
  <!-- Footer -->
  <footer>
    <!-- Copyright -->
  </footer>
</body>
</html>
```

#### Header 영역
- **위치**: 화면 최상단
- **높이**: 50px
- **컴포넌트**:
  - HOME 링크
  - 로그인 상태 표시 (sec:authorize)
  - 로그인/회원가입 링크 (비로그인 시)
  - 사용자명 + 로그아웃 링크 (로그인 시)

#### Navigation Bar
- **위치**: Header 아래
- **높이**: 60px
- **메뉴 항목**:
  1. 병원소개
  2. 진료안내
  3. 온라인상담
  4. 커뮤니티 (Dropdown)
     - 공지사항
     - 자유게시판
  5. 회원서비스 (Dropdown) - 로그인 시
     - 마이페이지
     - 로그아웃

---

## 3. 사용자 인증 화면

### 3.1 로그인 화면 (user/login.html)

#### URL
- **경로**: `/login`
- **Method**: GET (폼 표시), POST (로그인 처리)

#### 레이아웃
```
┌─────────────────────────────────────┐
│          로그인                      │
├─────────────────────────────────────┤
│ [아이디]                             │
│ ┌─────────────────────────────────┐ │
│ │ 아이디를 입력하세요              │ │
│ └─────────────────────────────────┘ │
│                                     │
│ [비밀번호]                           │
│ ┌─────────────────────────────────┐ │
│ │ 비밀번호를 입력하세요            │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ☐ 자동 로그인 (7일간 유지)          │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │        로그인                    │ │
│ └─────────────────────────────────┘ │
│                                     │
│ [회원가입] | [아이디/비밀번호 찾기]  │
│                                     │
│ ℹ️ 회원 로그인 안내                  │
│ • 회원가입 후 로그인 가능           │
│ • 자동 로그인 체크 시 7일간 유지    │
│ • 공용 PC에서는 사용하지 마세요     │
└─────────────────────────────────────┘
```

#### 입력 필드
| 필드명 | 타입 | 필수 | 검증 | 설명 |
|--------|------|------|------|------|
| username | text | ✅ | - | 사용자 ID |
| password | password | ✅ | minlength=8 | 비밀번호 |
| remember-me | checkbox | ❌ | - | 자동 로그인 (7일) |

#### 동작
1. **로그인 성공**: 
   - 마지막 로그인 시간/IP 업데이트
   - 메인 페이지(`/`)로 리다이렉트
   
2. **로그인 실패**:
   - 오류 메시지 표시: "아이디 또는 비밀번호가 올바르지 않습니다."
   - `/login?error=true`로 리다이렉트

3. **Remember-Me**:
   - 체크 시: `persistent_logins` 테이블에 토큰 저장
   - 유효기간: 7일 (604800초)

#### Flash 메시지
- `?error=true`: 로그인 실패
- `?logout=true`: 로그아웃 완료
- `message`: 회원가입 완료

---

### 3.2 회원가입 화면 (user/register.html)

#### URL
- **경로**: `/register`
- **Method**: GET (폼 표시), POST (회원가입 처리)

#### 레이아웃
```
┌─────────────────────────────────────┐
│          회원가입                    │
├─────────────────────────────────────┤
│ [아이디 *]                           │
│ ┌─────────────────────────────────┐ │
│ │ 4-20자의 영문, 숫자              │ │
│ └─────────────────────────────────┘ │
│                                     │
│ [비밀번호 *]                         │
│ ┌─────────────────────────────────┐ │
│ │ 8자 이상의 비밀번호              │ │
│ └─────────────────────────────────┘ │
│                                     │
│ [비밀번호 확인 *]                    │
│ ┌─────────────────────────────────┐ │
│ │ 비밀번호를 다시 입력하세요       │ │
│ └─────────────────────────────────┘ │
│ ⚠️ 비밀번호가 일치하지 않습니다      │
│                                     │
│ [이름 *]                             │
│ ┌─────────────────────────────────┐ │
│ │ 실명을 입력하세요                │ │
│ └─────────────────────────────────┘ │
│                                     │
│ [이메일 *]                           │
│ ┌─────────────────────────────────┐ │
│ │ example@email.com                │ │
│ └─────────────────────────────────┘ │
│                                     │
│ [전화번호]                           │
│ ┌─────────────────────────────────┐ │
│ │ 010-1234-5678                    │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │        회원가입                  │ │
│ └─────────────────────────────────┘ │
│                                     │
│ [로그인으로 돌아가기]                │
└─────────────────────────────────────┘
```

#### 입력 필드
| 필드명 | 타입 | 필수 | 검증 | 설명 |
|--------|------|------|------|------|
| username | text | ✅ | pattern="[a-zA-Z0-9]{4,20}" | 사용자 ID |
| password | password | ✅ | minlength=8 | 비밀번호 |
| passwordConfirm | password | ✅ | match(password) | 비밀번호 확인 |
| name | text | ✅ | - | 이름 |
| email | email | ✅ | email format | 이메일 |
| phone | tel | ❌ | pattern="[0-9]{2,3}-[0-9]{3,4}-[0-9]{4}" | 전화번호 |

#### 동작
1. **실시간 검증 (JavaScript)**:
   - 비밀번호 확인: 입력 시 일치 여부 실시간 체크
   - 불일치 시 빨간색 경고 메시지 표시
   
2. **회원가입 성공**:
   - 사용자 정보 저장 (비밀번호 BCrypt 해싱)
   - 기본 권한: ROLE_USER
   - Flash 메시지: "회원가입이 완료되었습니다."
   - `/login`으로 리다이렉트
   
3. **회원가입 실패**:
   - 오류 메시지 표시 (아이디 중복, 이메일 중복 등)
   - 입력 폼 유지

---

## 4. 온라인상담 화면

### 4.1 목록 화면 (counsel/counselList.html)

#### URL
- **경로**: `/counsel/list`
- **Method**: GET
- **파라미터**: 
  - `page`: 페이지 번호 (기본값: 0)
  - `type`: 검색 유형 (title, content, author)
  - `keyword`: 검색 키워드

#### 레이아웃
```
┌─────────────────────────────────────────────────┐
│  온라인상담                                      │
├─────────────────────────────────────────────────┤
│  [검색] [제목▼] [___________] [검색]  [글쓰기]  │
├────┬────────────────┬──────┬────┬────┬────────┤
│ No │     제목        │ 작성자│조회│상태│  날짜   │
├────┼────────────────┼──────┼────┼────┼────────┤
│112 │ 강아지 중성화.. │ 김*  │ 15 │완료│11-06   │
│    │  └ Re: 답변드.. │ 운영자│  - │  - │11-06   │
├────┼────────────────┼──────┼────┼────┼────────┤
│111 │ [비공개] 고양이 │ 이*  │  8 │대기│11-05   │
├────┼────────────────┼──────┼────┼────┼────────┤
│110 │ 예방접종 문의   │ 박*  │ 23 │완료│11-04   │
│    │  └ Re: 답변드.. │ 운영자│  - │  - │11-04   │
├────┴────────────────┴──────┴────┴────┴────────┤
│  < 1 2 3 4 5 6 7 8 9 10 >                      │
└─────────────────────────────────────────────────┘
```

#### 테이블 컬럼
| 컬럼 | 너비 | 정렬 | 설명 |
|------|------|------|------|
| No | 60px | center | 게시글 번호 |
| 제목 | auto | left | 제목 + 댓글 (들여쓰기) |
| 작성자 | 100px | center | 이름 (마스킹) |
| 조회 | 60px | center | 조회수 |
| 상태 | 80px | center | 배지 (답변대기/답변완료/상담종료) |
| 날짜 | 100px | center | 작성일 (MM-DD) |

#### 배지 스타일
- **답변대기**: `badge bg-warning` (노란색)
- **답변완료**: `badge bg-success` (초록색)
- **상담종료**: `badge bg-secondary` (회색)

#### 댓글 표시
- 들여쓰기: `padding-left: 20px`
- 아이콘: `↳ Re:`
- 작성자: 운영자 (초록색 배지)
- 조회수/상태: 표시 안 함

#### 동작
1. **검색**:
   - 제목, 내용, 작성자로 검색
   - 키워드 입력 후 검색 버튼 클릭
   
2. **페이징**:
   - 페이지당 10개 게시글
   - 페이지 번호 클릭 시 해당 페이지로 이동
   
3. **상세 보기**:
   - 제목 클릭 시 상세 화면으로 이동
   - 공개 글: 바로 이동
   - 비공개 글: 비밀번호 입력 화면으로 이동

---

### 4.2 상세 화면 (counsel/counselDetail.html)

#### URL
- **경로**: `/counsel/detail/{id}`
- **Method**: GET

#### 레이아웃
```
┌─────────────────────────────────────────────────┐
│  강아지 중성화 수술 문의                         │
├─────────────────────────────────────────────────┤
│  작성자: 김철수    작성일: 2025-11-06 14:30     │
│  조회수: 15        상태: [답변완료]              │
├─────────────────────────────────────────────────┤
│  안녕하세요. 1살 된 강아지 중성화 수술에 대해   │
│  문의드립니다...                                 │
│                                                 │
│  [첨부파일]                                      │
│  📎 dog_photo.jpg (1.2MB) [다운로드]            │
├─────────────────────────────────────────────────┤
│  [수정] [삭제] [목록]                            │
├─────────────────────────────────────────────────┤
│  💬 답변 (1)                                     │
├─────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────┐   │
│  │ 운영자 [운영자]      2025-11-06 15:00   │   │
│  │ 안녕하세요. 중성화 수술은...            │   │
│  │                          [삭제]         │   │
│  └─────────────────────────────────────────┘   │
└─────────────────────────────────────────────────┘
```

#### 정보 표시
- **제목**: 게시글 제목
- **작성자**: 이름 (마스킹 없음)
- **작성일**: `yyyy-MM-dd HH:mm` 형식
- **조회수**: 숫자
- **상태**: 배지 (답변대기/답변완료/상담종료)
- **공개 여부**: 비공개인 경우 "🔒 비공개" 표시

#### 첨부파일
- 파일명 + 크기 표시
- 다운로드 버튼
- 아이콘: 📎

#### 버튼
- **수정**: 비밀번호 검증 후 수정 화면으로 이동
- **삭제**: 비밀번호 검증 후 삭제 (Soft Delete)
- **목록**: 목록 화면으로 이동

#### 댓글 영역
- **제목**: "💬 답변 (댓글 개수)"
- **댓글 카드**:
  - 배경색: 연한 회색
  - 테두리: 1px solid #ddd
  - 작성자 + 배지 (운영자인 경우)
  - 작성일: `yyyy-MM-dd HH:mm`
  - 내용
  - 삭제 버튼 (비밀번호 검증)

#### 대댓글 (트리 구조)
- 들여쓰기: `margin-left: 40px`
- 테두리: 왼쪽 파란색 선 `border-left: 3px solid #007bff`
- 아이콘: `↳`

---

### 4.3 비밀번호 입력 화면 (counsel/counselPassword.html)

#### URL
- **경로**: `/counsel/detail/{id}/password`
- **Method**: GET (폼 표시), POST (비밀번호 검증)

#### 레이아웃
```
┌─────────────────────────────────────┐
│    🔒 비공개 게시글                  │
├─────────────────────────────────────┤
│  이 게시글은 비공개로 설정되어 있습니다│
│  비밀번호를 입력해주세요.             │
│                                     │
│  [비밀번호]                          │
│  ┌─────────────────────────────────┐│
│  │ 비밀번호를 입력하세요            ││
│  └─────────────────────────────────┘│
│                                     │
│  ┌─────────────────────────────────┐│
│  │        확인                      ││
│  └─────────────────────────────────┘│
│                                     │
│  [목록으로 돌아가기]                 │
└─────────────────────────────────────┘
```

#### 동작
1. **비밀번호 확인**:
   - BCrypt 해시 비교
   - 일치 시: 세션에 `counselUnlocked` Set에 게시글 ID 추가
   - 불일치 시: 오류 메시지 표시

2. **세션 관리**:
   - 세션에 unlock된 게시글 ID 저장
   - 브라우저 종료 시 세션 초기화

---

### 4.4 글쓰기 화면 (counsel/counselWrite.html)

#### URL
- **경로**: `/counsel/write`
- **Method**: GET (폼 표시), POST (글 등록)

#### 레이아웃
```
┌─────────────────────────────────────────────────┐
│  온라인상담 글쓰기                               │
├─────────────────────────────────────────────────┤
│  [제목]                                          │
│  ┌─────────────────────────────────────────────┐│
│  │ 제목을 입력하세요                            ││
│  └─────────────────────────────────────────────┘│
│                                                 │
│  [작성자]                                        │
│  ┌─────────────────────────────────────────────┐│
│  │ 이름을 입력하세요                            ││
│  └─────────────────────────────────────────────┘│
│                                                 │
│  [이메일]                                        │
│  ┌─────────────────────────────────────────────┐│
│  │ example@email.com                            ││
│  └─────────────────────────────────────────────┘│
│                                                 │
│  [내용]                                          │
│  ┌─────────────────────────────────────────────┐│
│  │                                             ││
│  │                                             ││
│  │                                             ││
│  └─────────────────────────────────────────────┘│
│                                                 │
│  [첨부파일]                                      │
│  ┌─────────────────────────────────────────────┐│
│  │ 파일 선택                                    ││
│  └─────────────────────────────────────────────┘│
│  ⚠️ 이미지 파일만 업로드 가능 (최대 5MB)         │
│                                                 │
│  ☐ 비공개로 작성                                 │
│                                                 │
│  [비밀번호] (비공개 체크 시만 표시)              │
│  ┌─────────────────────────────────────────────┐│
│  │ 비밀번호를 입력하세요                        ││
│  └─────────────────────────────────────────────┘│
│                                                 │
│  [등록] [취소]                                   │
└─────────────────────────────────────────────────┘
```

#### 입력 필드
| 필드명 | 타입 | 필수 | 검증 | 설명 |
|--------|------|------|------|------|
| title | text | ✅ | maxlength=255 | 제목 |
| authorName | text | ✅ | maxlength=100 | 작성자 이름 |
| authorEmail | email | ❌ | email format | 이메일 |
| content | textarea | ✅ | - | 내용 |
| attachments | file | ❌ | image/* | 첨부파일 (이미지만) |
| secret | checkbox | ❌ | - | 비공개 여부 |
| password | password | ❌ | minlength=4 | 비밀번호 (비공개 시 필수) |

#### 동작
1. **비공개 체크**:
   - 체크 시: 비밀번호 입력 필드 표시
   - 체크 해제 시: 비밀번호 입력 필드 숨김

2. **파일 업로드**:
   - 허용 MIME 타입: image/jpeg, image/png, image/gif
   - 최대 크기: 5MB
   - 파일명: UUID로 난수화
   - 저장 경로: `data/counsel/uploads/yyyy/MM/`

3. **글 등록**:
   - 본문: HTML 파일로 저장 (`data/counsel/contents/yyyy/MM/`)
   - 상태: WAIT (답변대기)
   - 공개 여부: secret 값에 따라
   - 비밀번호: BCrypt 해싱 (비공개 시)

---

## 5. 커뮤니티 화면

### 5.1 목록 화면 (community/communityList.html)

#### URL
- **경로**: `/community/list`
- **Method**: GET
- **파라미터**:
  - `subject`: 게시판 구분 (notice, free)
  - `page`: 페이지 번호
  - `type`: 검색 유형
  - `keyword`: 검색 키워드

#### 레이아웃 (공지사항)
```
┌─────────────────────────────────────────────────┐
│  공지사항                                        │
├─────────────────────────────────────────────────┤
│  [검색] [제목▼] [___________] [검색]            │
├────┬────────────────────────┬──────┬────┬──────┤
│ No │         제목            │ 작성자│조회│ 날짜 │
├────┼────────────────────────┼──────┼────┼──────┤
│공지│ [공지] 홈페이지 오픈    │ 관리자│123 │11-01 │
├────┼────────────────────────┼──────┼────┼──────┤
│106 │ 정기 점검 안내          │ 관리자│ 45 │11-06 │
├────┼────────────────────────┼──────┼────┼──────┤
│105 │ 진료시간 변경 안내      │ 관리자│ 78 │11-05 │
├────┴────────────────────────┴──────┴────┴──────┤
│  < 1 2 3 4 5 6 7 8 9 10 >                      │
└─────────────────────────────────────────────────┘
```

#### 공지사항 표시
- 상단 고정
- 배경색: 연한 노란색 `#fffbf0`
- No 컬럼: "공지" 텍스트

---

## 6. 관리자 화면

### 6.1 관리자 메인 (admin/dashboard.html)

#### URL
- **경로**: `/admin`
- **권한**: ROLE_ADMIN
- **상태**: 🔴 미구현

#### 계획 레이아웃
```
┌─────────────────────────────────────────────────┐
│  관리자 대시보드                                 │
├─────────────────────────────────────────────────┤
│  ┌─────────┐ ┌─────────┐ ┌─────────┐          │
│  │ 회원수   │ │ 게시글  │ │ 댓글수  │          │
│  │  1,234  │ │   567   │ │  8,901  │          │
│  └─────────┘ └─────────┘ └─────────┘          │
│                                                 │
│  최근 온라인상담 (5건)                           │
│  - 강아지 중성화 문의 (답변대기)                 │
│  - 예방접종 문의 (답변완료)                      │
│  ...                                            │
└─────────────────────────────────────────────────┘
```

---

## 7. 변경 이력

### [3.5.3] - 2025-11-06

#### 신규 화면
- **user/login.html**: 로그인 화면
  - Remember-Me 기능
  - Flash 메시지 표시
  
- **user/register.html**: 회원가입 화면
  - 실시간 비밀번호 확인
  - 입력 유효성 검사

#### 수정 화면
- **fragments/layout.html**: 레이아웃
  - Thymeleaf Security 연동
  - 로그인 상태 표시
  - 로그인/로그아웃 링크

#### 미구현 화면
- 관리자 대시보드
- 마이페이지
- 비밀번호 찾기

---

### [3.5.1] - 2025-11-05

#### 신규 화면
- **counsel/counselList.html**: 온라인상담 목록
  - 페이징 (10개/페이지)
  - 검색 기능
  - 상태 배지
  
- **counsel/counselDetail.html**: 온라인상담 상세
  - 조회수 중복 방지
  - 댓글 트리 구조
  - 첨부파일 다운로드
  
- **counsel/counselPassword.html**: 비밀번호 입력
  - 비공개 글 접근 제어
  
- **counsel/counselWrite.html**: 글쓰기
  - 비공개 옵션
  - 파일 업로드

- **community/communityList.html**: 커뮤니티 목록
  - 게시판 구분 (공지사항/자유게시판)
  - 공지사항 상단 고정

---

## 📋 화면 관리 규칙

### 신규 화면 추가 시
1. ✅ UI_SCREEN_DEFINITION.md에 화면 명세 추가
2. ✅ 레이아웃 다이어그램 작성 (ASCII Art)
3. ✅ 입력 필드 테이블 작성
4. ✅ 동작 명세 작성
5. ✅ 변경 이력에 기록

### 화면 수정 시
1. ✅ 변경 이력에 날짜와 내용 기록
2. ✅ 레이아웃 다이어그램 업데이트
3. ✅ CHANGELOG.md에도 기록

### 화면 삭제 시
1. ✅ 변경 이력에 삭제 사유 기록
2. ✅ Deprecated 마킹 후 1개월 뒤 삭제

---

**문서 버전**: 1.0  
**최종 검토**: 2025-11-06  
**담당자**: Jeongmin Lee

